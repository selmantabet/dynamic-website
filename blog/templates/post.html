{% extends "layout.html" %} {% block content %}
<!-- <img src="{{ url_for('static', filename='img/' + post.image_file) }}" /> -->
<div class="modal-container">
  {% if post.image_file == "default.jpg" %}
    <img
      id="modalImg"
      src="{{ url_for('static', filename='img/' + post.image_file) }}"
      style="max-width: 80vw"
      class="img-fluid"
    />  
  {% else %}
  <img
      id="modalImg"
      src="{{ url_for('static', filename= 'uploads/' + post.author_id|string + '/' + post.image_file) }}"
      style="max-width: 80vw"
      class="img-fluid"
    />
  {% endif %}
    <div id="modalID" class="modal">
      <span class="close">&times;</span>
      <img class="modal-content" id="imgID" />
      <div id="caption"></div>
    </div>
</div>
    <!-- <img src="{{ url_for('static', filename='img/' + post.image_file) }}"> -->
  <!-- <div class="modal-container">
    <img
      id="modalImg"
      src="{{ url_for('static', filename= 'uploads/' + post.author_id|string + '/' + post.image_file) }}"
      style="max-width: 80vw"
    />
    <div id="modalID" class="modal">
      <span class="close">&times;</span>
      <img class="modal-content" id="imgID" />
      <div id="caption"></div>
    </div>
  </div> -->
    <!-- <img src="{{ url_for('static', filename= 'uploads/' + post.author_id|string + '/' + post.image_file) }}" width="600"></p> -->
  
<p>
  "{{ post.title }}" &nbsp Author:
  <a href="{{ url_for('user', user_id = post.user.id) }}"
    >{{ post.user.username }}</a
  > &nbsp <img src="{{ avatar }}" width="50" class="img-fluid">
</p>
<!-- Put some media here -->
<p>{{ post.content }}</p>
<br />


{% if current_user.is_authenticated %}
{% if current_user.id == post.author_id %}
<a href="{{ url_for('delete_post', post_id=post.id) }}" class="btn btn-danger">Delete Post</a>
{% endif %}
  {% endif %}
<h2>Comments ({{ post.comments|length }})</h2>
{% for comment in comments %}
<div>
  <p>
    Comment by:
    <a href="{{ url_for('user', user_id = comment[0].author_id) }}"
      >{{ comment[0].user.username }}</a
    > &nbsp <img
    src="{{ comment[1] }}"
    width="50"
    class="img-fluid"
  />
  {% if current_user.is_authenticated %}
  {% if current_user.id == comment[0].author_id %}
  <a href="{{ url_for('delete_comment', comment_id=comment[0].id) }}" class="btn btn-link">Delete Comment</a>
  {% endif %}
  {% endif %}
  </p>
  <p>{{ comment[0].content }}</p>
  <p>{{ comment[0].date }}</p>
</div>
</br>
{% endfor %} {% if current_user.is_authenticated %}
<form method="POST" action="">
  {{ form.csrf_token }}
  <div class="row g-3 align-items-center">
    <div class="col-auto">
      {{ form.content.label(class__='form-label') }}
      </div>
      <div class="col-auto">
        {{ form.content(class__='form-control') }}
      </div>
      <div class="col-auto">
        <input type="submit" class="btn btn-primary" value="Submit Comment" />
      </div>
  </div>
</form>
{% else %}
<p><a href="{{ url_for('login') }}">Sign in</a> to add a comment.</p>
{% endif %} 
<script src="{{ url_for('static', filename= 'modal-handler.js') }}"></script>
<!-- Remember this? XDDDD -->
<!-- My own work from the CMT119 assignment makes a guest appearance -->
{% endblock content %}

